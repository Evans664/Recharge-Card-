<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div>
      <label for="provider">Pick provider</label>
      <select name="provider" id="provider">
        <option value="">Choose provider</option>
        <option value="mtn">MTN</option>
        <option value="glo">GLO</option>
        <option value="airtel">AIRTEL</option>
        <option value="9mobile">9MOBILE</option>
      </select>
    </div>
    <div>
      <label for="provider">Pick Provider</label>
      <select name="provider" id="amount">
        <option value="">Choose amount</option>
        <option value="100">100</option>
        <option value="200">200</option>
        <option value="500">500</option>
        <option value="1000">1000</option>
      </select>
    </div>
    <button onclick="generatePin()">generate pin</button>
    <p>Pin: <span id="thePin"> no pin yet..</span></p>
    <div>
      <label for="loadcard">Load Card:</label>
      <input type="text" id="loadcard" value="*311*pin#" />
      <button onclick="loadCard()">Load card</button>
    </div>
    <div id="output">
                <table>
                    <thead>
                        <tr>
                            <th>Provider</th>
                            <th>Amount</th>
                            <th>Card</th>
                        </tr>
                    </thead>
                    <tbody id="tbody">
                       
                    </tbody>
                </table>
     </div>
  </body>
</html>
<script>
  let tbody = document.getElementById('tbody')
  let output = document.getElementById('output')
  let cards = [];

  function generatePin() {
    let provider = document.getElementById("provider").value;
  let amount = document.getElementById("amount").value;
    let thePin = document.getElementById("thePin");
    if (!provider || !amount) {
      alert("All fields are mandatory");
    } else {
      let pin = "";
      for (let index = 0; index < 12; index++) {
        let randomNum = Math.floor(Math.random() * 10);
        pin += randomNum;
      }
      thePin.innerHTML = pin;

  
      let card = {
        pin,
        provider,
        amount,
        used: false
      };

      cards[pin] = card;
    }
  }

  function loadCard() {
    let loadInput = document.getElementById("loadcard").value.trim()
    let twelveDigit = loadInput.slice(5, 17);
    let provider = document.getElementById("provider").value;
    let amount = document.getElementById("amount").value;

    if (loadInput !== `*311*${twelveDigit}#`) {
      alert("Invalid Format");
    } else {
      console.log(twelveDigit);

      let foundCard = cards[twelveDigit];

      if (!foundCard) {
        alert("Invalid Card");
      } else if (foundCard.used === true) {
        alert("Card has been used");
      } else {
        foundCard.used = true;
        alert(`You have successfully recharged ${foundCard.amount}`);
      }
    }
    tbody.innerHTML += `
                    <tr>
                    <td>${provider}</td>
                    <td>${amount}</td>
                    <td>${twelveDigit}</td>
                </tr>
    `
  }
</script>

